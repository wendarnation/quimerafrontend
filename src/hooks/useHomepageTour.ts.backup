import { useEffect, useRef } from 'react';
import { driver } from 'driver.js';

export const useHomepageTour = () => {
  const driverRef = useRef<any>(null);

  useEffect(() => {
    // Inicializar driver.js - Versión actualizada
    driverRef.current = driver({
      showProgress: true,
      stagePadding: 4,
      stageRadius: 10,
      allowClose: true,
      overlayColor: 'black',
      overlayOpacity: 0.7,
      smoothScroll: true,
      showButtons: ['next', 'previous', 'close'],
      nextBtnText: 'Siguiente →',
      prevBtnText: '← Anterior',
      doneBtnText: '✕ Cerrar',
      popoverClass: 'driverjs-theme',
      steps: [
        {
          element: '[data-tour="search-bar"]',
          popover: {
            title: '🔍 Barra de Búsqueda',
            description: 'Aquí puedes buscar sneakers por marca, modelo o SKU. ¡Prueba escribiendo "Jordan", "Nike" o cualquier modelo que te interese!',
            side: 'bottom',
            align: 'center'
          }
        },
        {
          element: '[data-tour="nav-news"]',
          popover: {
            title: '📰 Noticias',
            description: 'Mantente al día con las últimas noticias del mundo de las sneakers, lanzamientos y tendencias.',
            side: 'bottom',
            align: 'center'
          }
        },
        {
          element: '[data-tour="nav-about"]',
          popover: {
            title: '🎯 Acerca de',
            description: 'Conoce nuestra misión de democratizar el acceso a las sneakers y descubre qué nos motiva.',
            side: 'bottom',
            align: 'center'
          }
        },
        {
          element: '[data-tour="nav-contact"]',
          popover: {
            title: '📧 Contacta',
            description: '¿Tienes alguna pregunta o sugerencia? Contáctanos a través de esta sección.',
            side: 'bottom',
            align: 'center'
          }
        },
        {
          element: '[data-tour="user-section"]',
          popover: {
            title: '👤 Sección de Usuario',
            description: 'Aquí puedes acceder a tus favoritos, configuración de perfil y todas las funciones personalizadas de tu cuenta.',
            side: 'bottom',
            align: 'center'
          }
        },
        {
          element: '[data-tour="trending-section"]',
          popover: {
            title: '🔥 Novedades',
            description: 'Las sneakers más recientes y en tendencia. Desliza para ver más modelos o haz clic en "Ver todas" para explorar todo nuestro catálogo.',
            side: 'top',
            align: 'center'
          }
        },
        {
          element: '[data-tour="recommended-section"]',
          popover: {
            title: '⭐ Recomendaciones',
            description: 'Sneakers seleccionadas especialmente para ti basadas en tendencias y popularidad. ¡Encuentra tu próximo par favorito!',
            side: 'top',
            align: 'center'
          }
        },
        {
          element: '[data-tour="featured-images"]',
          popover: {
            title: '🎨 Colecciones Destacadas',
            description: 'Explora nuestras colecciones especiales por marca. Cada imagen te llevará a una selección curada de esa marca específica.',
            side: 'top',
            align: 'center'
          }
        }
      ]
    });

    return () => {
      if (driverRef.current) {
        driverRef.current.destroy();
      }
    };
  }, []);

  const startTour = () => {
    if (driverRef.current) {
      driverRef.current.drive();
    }
  };

  return { startTour };
};
